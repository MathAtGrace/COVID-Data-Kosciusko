---
title: "COVID19 Data Near Kosciusko County"
author: "Compiled by Dr. Ryan Johnson using data from [@COVID19]"
date: "Last updated `r format(Sys.time(), '%A, %B %d, %Y')`"
output:
  html_document:
    df_print: paged
bibliography: bibliography.bib
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(COVID19)
require(tidyverse)
library(dplyr)
library(lubridate)
library(scales)
library(usmap)

#Input parameters
per = 8*10^4 #dislplay rates per how many people?
per_word = "Eighty Thousand"
data_start = as.Date("2020-03-20") #Start data at this day
states <- c("Michigan", "Illinois", "Ohio", "Kentucky")
KOS_neighbor_counties <- c("Fulton", "Marshall", "Elkhart", "Noble", "Whitley", "Allen", "Wabash")
#outbreaks = c("Cass", "Marion", "Decatur", "Lake")

#Get data and subset to states we want
US_states <- covid19("US", level = 2, start = data_start)

#What is the latest date of the data?
yest <- max(US_states$date)

#Get per-day numbers
US_states$difdeaths <- prepend(diff(US_states$deaths), 0)
US_states$difconfirmed <- prepend(diff(US_states$confirmed), 0)
US_states$diftests <- prepend(diff(US_states$tests), 0)
US_states$difhosp <- prepend(diff(US_states$hosp), 0)

#Get per-population numbers
US_states$confirmedper <- US_states$confirmed / US_states$pop * per
US_states$deathsper <- US_states$deaths / US_states$pop * per
US_states$testsper <- US_states$tests / US_states$tests * per
US_states$difconfirmed_per <- US_states$difconfirmed / US_states$pop * per
US_states$difdeaths_per <- US_states$difdeaths / US_states$pop * per
US_states$diftests_per <- US_states$diftests / US_states$pop * per
US_states$difhosp_per <- US_states$difhosp / US_states$pop * per

#Some convenient date subsets
covyest <- US_states[US_states$date == yest,]
covlabel <- US_states[US_states$date == as.Date("2020-04-20"),]
cov5 <- US_states[US_states$date <= yest & US_states$date > (yest - 5),]
cov14 <- US_states[US_states$date <= yest & US_states$date > (yest - 14),]

#State-level subsets
Indiana <- subset(US_states, state == "Indiana")
IN_neighbors <- subset(US_states, state %in% states)

#County Level Data
US_counties <- covid19("US", level = 3, start = data_start)
IN_counties <- subset(US_counties, state == "Indiana")
IN_counties$county <- as.factor(IN_counties$city)

#Get per-day numbers
IN_counties$difdeaths <- prepend(diff(IN_counties$deaths), 0)
IN_counties$difconfirmed <- prepend(diff(IN_counties$confirmed), 0)
IN_counties$diftests <- prepend(diff(IN_counties$tests), 0)

#Get per-population numbers
IN_counties$confirmedper <- IN_counties$confirmed / IN_counties$pop * per
IN_counties$deathsper <- IN_counties$deaths / IN_counties$pop * per
IN_counties$testsper <- IN_counties$tests / IN_counties$tests * per
IN_counties$difconfirmed_per <- IN_counties$difconfirmed / IN_counties$pop * per
IN_counties$difdeaths_per <- IN_counties$difdeaths / IN_counties$pop * per
IN_counties$diftests_per <- IN_counties$diftests / IN_counties$pop * per

IN7 <- IN_counties[US_states$date <= yest & US_states$date > (yest - 7),]
Indices <- aggregate(cbind(difconfirmed_per, difdeaths_per) ~ county, data = IN7, FUN = sum)
Indices$case_index <- Indices$difconfirmed_per/sum(Indices$difconfirmed_per)
Indices$death_index <- Indices$difdeaths_per/sum(Indices$difdeaths_per)
Indices$combined <- sqrt(Indices$case_index^2 + Indices$death_index^2)
Indices <- Indices[order(-Indices$combined),]
outbreaks <- Indices$county[1:6]

Indices$fips <- fips("IN", county = Indices$county)

Kos <- subset(IN_counties, county == "Kosciusko")
IN_outbreak <- subset(IN_counties, county %in% outbreaks)
KOS_neighbors <- subset(IN_counties, county %in% KOS_neighbor_counties)

gg_color_hue <- function(n) {
  hues = seq(15, 375, length = n + 1)
  hcl(h = hues, l = 65, c = 100)[1:n]
}
```

&nbsp;

#### All counts will be reported as per 80,000 because that is roughly the population of Kosciusko County.

&nbsp;

# Indiana State Data

&nbsp;

### Hospitalizations - Indiana

Govenor Holcomb as decided that hopspitalization numbers are one of the most important indicators for how we are doing.

This graph starts much later than the others because hospitalization numbers were not reported until April 25.

The blue dashed lines are smoothed weighted averages.

```{r, echo=FALSE, fig.width=6, fig.height=3, message=FALSE}
IN_Hosp <- subset(Indiana, date > as.Date("2020-04-25"))
ggplot(IN_Hosp, aes(x = date, y = difhosp_per)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="2 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Indiana New Hospitalizations per", per_word, "People")) + 
  theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size = 15)) + 
  ylab(paste("New Hosps per", as.character(per), "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed")
```

### Cases - Indiana

```{r, echo=FALSE, fig.width=12, fig.height=5, message=FALSE, warning=FALSE}
ggplot(Indiana, aes(x = date, y = difconfirmed_per)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Indiana New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed")
```

### Percentage of Positive Tests

The percentage of tests coming back positive is one way to measure the prevalence of testing.

```{r, echo=FALSE, fig.width = 12, fig.height = 5, message=FALSE, warning = FALSE}
ggplot(Indiana, aes(x = date, y = (difconfirmed / diftests))) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  coord_cartesian(ylim = c(0,.5)) +
  scale_y_continuous(oob = squish, labels = scales::percent) +
  ggtitle("Indiana Percentage of Positive Tests Each Day") + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab("Percent Positive") + 
  xlab("Date") +
  geom_point(size = 4) +
  stat_smooth(linetype = "dashed", se = FALSE)
```

### Deaths - Indiana

```{r, echo=FALSE, fig.width=12, fig.height=5, message=FALSE, warning=FALSE}
ggplot(Indiana, aes(x = date, y = difdeaths_per)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Indiana New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Deaths per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed")
```

&nbsp;

# Kosciusko Data

&nbsp;

Note that the y-axis scales of these graphs are different than the state-level data.

### Cases - Kosciusko

```{r, echo=FALSE, fig.width=12, fig.height=5, message=FALSE, warning=FALSE}
ggplot(Kos, aes(x = date, y = difconfirmed_per)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Kosciusko New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed")
```

### Deaths - Kosciusko

```{r, echo=FALSE, fig.width=12, fig.height=5, message=FALSE, warning=FALSE}
ggplot(Kos, aes(x = date, y = difdeaths_per)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Kosciusko New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Deaths per", per_word, "People")) + 
  xlab("Date")
```

&nbsp;

# Indiana Outbreaks

The coloring scheme for the map below is based on a combination of new cases and new deaths per captita in the past week.  The coloring scheme is relative, it will always color the worst county pure red.

```{r, echo=FALSE, fig.width=12, fig.height=14, warning=FALSE, message=FALSE}
plot_usmap("counties",
           data = Indices, values = "combined", color = "blue",
           include = Indices$fips, labels = TRUE) + 
    scale_fill_continuous(name = "Outbreak Index",
                          low = "white", high = "red") + 
    theme(legend.position = "right")
```


&nbsp;

Below are the six counties in Indiana with the worst combination of new confirmed cases and new confirmed deaths over the past week.

Note that the y-axis scales of these graphs are different than other sections.

### Cases - Outbreaks in Indiana

```{r, echo=FALSE, fig.width=12, fig.height=5, warning=FALSE, message=FALSE}
ggplot(IN_outbreak, aes(x = date,
                     y = difconfirmed_per, color = county)) + 
  stat_smooth(size = 2, se = FALSE) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Outbreaks - New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date")
```

The chart below does not contain two outliers for Cass County.  On April 26th, Cass County reported 271 new cases (575 per 80,000), and on April 27th, Cass County reported 439 new cases (932 per 80,000).

```{r echo=FALSE, fig.width=12, fig.height=5, message = FALSE, warning=FALSE}
ggplot(IN_outbreak, aes(x = date, y = difconfirmed_per, color = county)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  coord_cartesian(ylim = c(0,200)) +
  scale_y_continuous(oob = squish) +
  ggtitle(paste("Outbreaks - New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed") +
  facet_wrap(vars(county), nrow = 3, ncol = 2)
```


### Deaths - Outbreaks in Indiana

```{r, echo=FALSE, fig.width=12, fig.height=5, warning=FALSE, message=FALSE}
ggplot(IN_outbreak, aes(x = date,
                     y = difdeaths_per, color = county)) + 
  stat_smooth(size = 2, se = FALSE) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Outbreaks - New Deaths per", per_word, "People")) + 
  xlab("Date")
```

```{r, echo=FALSE, fig.width = 12, fig.height = 5, message=FALSE, warning = FALSE}
#Plot Deaths per Million per Day
ggplot(IN_outbreak, aes(x = date, y = difdeaths_per, color = county)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Outbreaks - New Deaths per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed") +
  facet_wrap(vars(county), nrow = 3, ncol = 2)
```

&nbsp;

# Neighboring Counties

&nbsp;

Note that the y-axis scales of these graphs are different than other sections.

### Cases - Counties Neighboring Kosciusko

The first chart is a comparison of smoothed weighted averages.  The second chart is the actual data.

```{r, echo=FALSE, fig.width=12, fig.height=5, warning=FALSE, message=FALSE}
KOS_plus <- rbind(KOS_neighbors, Kos)
KOS_plus$county <- droplevels(KOS_plus$county)
n = length(KOS_neighbor_counties)
m = match("Kosciusko", levels(KOS_plus$county)) - 1
c_vals = append(gg_color_hue(n), "black", after = m)
names(c_vals) <- levels(KOS_plus$county)
ggplot(KOS_plus, aes(x = date,
                     y = difconfirmed_per, color = county)) + 
  stat_smooth(size = 2, se = FALSE) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date") + 
  scale_color_manual(values = c_vals)
```

```{r, echo=FALSE, fig.width=12, fig.height=8, warning=FALSE, message=FALSE}
#Plot Confirmed per Million per Day
#breaks <- 10^(-10:10)
#minor_breaks <- rep(1:9, 21)*(10^rep(-10:10, each=9))
ggplot(KOS_neighbors, aes(x = date, y = difconfirmed_per, color = county)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Cases per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Cases per", per_word, "People")) + 
  xlab("Date") +
  facet_wrap(vars(county), nrow = 6, ncol = 2)
```


&nbsp;

### Deaths - Counties Neighboring Kosciusko

The first chart is a comparison of smoothed weighted averages.  The second chart is the actual data.

```{r, echo=FALSE, fig.width=12, fig.height=5, warning=FALSE, message=FALSE}
ggplot(KOS_plus, aes(x = date,
                     y = difdeaths_per, color = county)) + 
  stat_smooth(size = 2, se = FALSE) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("New Deaths per", per_word, "People")) + 
  xlab("Date") + 
  scale_color_manual(values = c_vals)
```

```{r, echo=FALSE, fig.width=12, fig.height=8, warning=FALSE, message=FALSE}
#Plot Confirmed per Million per Day
#breaks <- 10^(-10:10)
#minor_breaks <- rep(1:9, 21)*(10^rep(-10:10, each=9))
ggplot(KOS_neighbors, aes(x = date, y = difdeaths_per, color = county)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
#  scale_y_log10(breaks = breaks, minor_breaks = minor_breaks) + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("New Confirmed Deaths per", per_word, "People")) + 
  theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size = 15)) + 
  ylab(paste("New Deaths", per_word, "People")) + 
  xlab("Date") +
  facet_wrap(vars(county), nrow = 6, ncol = 2)
```


&nbsp;

# Neighboring States Data

&nbsp;

Note that the y-axis scales of these graphs are different than other sections.

### Cases - States Neighboring Indiana

The first plot is a comparison of smoothed weighted averages.  The second is the actual data.

```{r, echo=FALSE, fig.width = 12, fig.height = 5, message=FALSE, warning=FALSE}
#Plot Deaths per Million per Day
IN_and_neighbors <- rbind(IN_neighbors, Indiana)
ggplot(IN_and_neighbors, aes(x = date, y = difconfirmed_per, color = state)) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Confirmed Cases per Day per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Cases per Day per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 2, se = FALSE) +
  scale_color_manual(values = c("Indiana" = "black", "Michigan" = "#00BFC4", "Illinois" = "#F8766D", "Ohio" = "#C77CFF", "Kentucky" = "#7CAE00"))
```

```{r, echo=FALSE, fig.width = 12, fig.height = 6, message=FALSE, warning=FALSE}
#Plot Deaths per Million per Day
ggplot(IN_neighbors, aes(x = date, y = difconfirmed_per, color = state)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Confirmed Cases per Day per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Cases per Day per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed") +
  facet_wrap(vars(state), nrow = 3, ncol = 2)
```


### Deaths - States Neighboring Indiana

The first plot is a comparison of smoothed weighted averages.  The second is the actual data.

```{r, echo=FALSE, fig.width = 12, fig.height = 5, message=FALSE, warning=FALSE}
#Plot Deaths per Million per Day
ggplot(IN_and_neighbors, aes(x = date, y = difdeaths_per, color = state)) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Confirmed Deaths per Day per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Deaths per Day per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 2, se = FALSE) +
  scale_color_manual(values = c("Indiana" = "black", "Michigan" = "#00BFC4", "Illinois" = "#F8766D", "Ohio" = "#C77CFF", "Kentucky" = "#7CAE00"))
```

```{r, echo=FALSE, fig.width = 12, fig.height = 6, message=FALSE, warning=FALSE}
#Plot Deaths per Million per Day
ggplot(IN_neighbors, aes(x = date, y = difdeaths_per, color = state)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
  scale_y_continuous(limit=c(0,NA), oob = squish) +
  ggtitle(paste("Deaths per Day per", per_word, "People")) + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Deaths per Day per", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed") +
  facet_wrap(vars(state), nrow = 3, ncol = 2)
```


### Positive Test Rate - States Neighboring Indiana

Looking at the percentage of tests that come back positive can signal which states might have low case numbers because of lack of testing.

For example, Michigan had a much higher death rate per capita than Illinois in mid-April, even though their case numbers per capita were only a little higher in late March and early April.  Michigan's high postive test rate late March and early April suggests that Michigan had worse testing than Illinois during that time.

The first plot is a comparison of smoothed weighted averages.  The second is the actual data.

```{r, echo=FALSE, fig.width = 12, fig.height = 5, message=FALSE, warning = FALSE}
#Plot Deaths per Million per Day
ggplot(IN_and_neighbors, aes(x = date, y = (difconfirmed / diftests), color = state)) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="3 days",
               minor_breaks = "1 day") + 
  coord_cartesian(ylim = c(0,.5)) +
  scale_y_continuous(oob = squish, labels = scales::percent) +
  ggtitle("Percentage of Positive Tests Each Day") + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab("Percent Positive") + 
  xlab("Date") +
  stat_smooth(size = 2, se = FALSE) +
  scale_color_manual(values = c("Indiana" = "black", "Michigan" = "#00BFC4", "Illinois" = "#F8766D", "Ohio" = "#C77CFF", "Kentucky" = "#7CAE00"))
```

Warning: the plots below contain several outliers where 

```{r, echo=FALSE, fig.width = 12, fig.height = 6, message=FALSE, warning=FALSE}
#Plot Deaths per Million per Day
ggplot(IN_neighbors, aes(x = date, y = (difconfirmed / diftests), color = state)) + 
  geom_point(size = 4) +
  scale_x_date(date_labels="%b %d",
               date_breaks  ="6 days",
               minor_breaks = "1 day") + 
  coord_cartesian(ylim = c(0,.5)) +
  scale_y_continuous(oob = squish, labels = scales::percent) +
  ggtitle("Percentage of Positive Tests Each Day") + 
  theme(plot.title = element_text(size= 20, hjust = 0.5),
        legend.text = element_text(size = 15)) + 
  ylab(paste("Percent Positive", per_word, "People")) + 
  xlab("Date") +
  stat_smooth(size = 1, se = FALSE, linetype = "dashed") +
  facet_wrap(vars(state), nrow = 3, ncol = 2)
```





Data Source: